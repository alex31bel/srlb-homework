# Домашнее задание к занятию 10.4 «Резервное копирование»---### Задание 1В чём разница между:- полным резервным копированием,- дифференциальным резервным копированием,- инкрементным резервным копированием.*Приведите ответ в свободной форме.***Full Backup: ПОЛНОЕ РЕЗЕРВНОЕ КОПИРОВАНИЕ**Данный метод создает полную копию набора исходных данных, поэтому является лучшим вариантом защиты с точки зрения управления и скорости восстановления данных. Но это метод занимает в разы больше времени, чем другие способы резервного копирования, а также создаёт значительную сетевую нагрузку.![Full_Backup](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-1-1.jpg)Обычно, полные резервные копии делают периодически и объединяют их с другими типами резервного копирования.**Преимущества Full Backup:*** быстрое восстановление данных* простое управление* все данные содержаться в одной резервной копии**Недостатки Full Backup:*** требует много места для хранения резервных копий* высокая загрузка сети* длительное выполнение резервного копирования**Differential Backup: ДИФФЕРЕНЦИАЛЬНОЕ РЕЗЕРВНОЕ КОПИРОВАНИЕ**Дифференциальный тип резервного копирования является промежуточным решением между полным резервным копированием и инкрементными резервными копиями. Подобно инкрементному резервному копированию, отправной точкой для дифференциальной резервной копии является создание полной резервной копии и резервное копирование только измененных данных. Однако, в отличие от инкрементных резервных копий, дифференциальная резервная копия сохраняет не данные, которые были изменены с момента последней резервной копии, а данные, которые были изменены с момента первоначальной полной резервной копии. Таким образом, полная резервная копия является постоянной точкой отсчета для последовательных резервных копий.![Differential_Backup](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-1-2.jpg)Дифференциальная резервная копия позволяет быстрее восстанавливать данные по сравнению с инкрементным резервным копированием, поскольку для этого требуется всего две части резервной копии: полная резервная копия и последняя дифференциальная резервная копия. Скорость резервного копирования / восстановления, находится где-то между полным и инкрементным методом резервного копирования. Резервное копирование выполняется быстрее, чем полная резервная копия, но медленнее, чем инкрементное резервное копирование. Восстановление выполняется медленнее, чем у полной резервной копии, но быстрее, чем у инкрементных резервных копий. Объем памяти, необходимый для дифференциального резервного копирования, по крайней мере на определенный период меньше, чем требуется для полного резервного копирования и больше, чем требуется для инкрементного резервного копирования.**Преимущества Differential Backup:*** Дифференциальное резервное копирование быстрее, чем полное, но медленнее, чем инкрементное* Восстановление быстрее, чем инкрементное, но медленнее чем полное* Дифференциальное резервное копирование надежнее, чем инкрементное (для восстановления требуется только полная и последняя резервная копия)**Недостатки Differential Backup:*** Каждый новый дифференциальный бэкап требует больше времени и места для хранения, чем предыдущий**Incremental Backup: ИНКРЕМЕНТНОЕ РЕЗЕРВНОЕ КОПИРОВАНИЕ**Инкрементное резервное копирование использует полную резервную копию как основу для создания будущих инкрементов. Каждая новая инкрементная резервная копия содержит только те блоки данных, которые были изменены с момента предыдущего копирования. Через заданный период в зависимости от политики хранения создается новая полная резервная копия и цикл повторяется заново.![Incremental_Backup](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-1-3.jpg)Резервное копирование замедляет работу продуктивных систем и требует значительное время, поэтому полное резервное копирование как правило выполняют по воскресеньям, а по рабочим выполняется бэкап только тех данных которые были изменены с момента последнего копирования (инкременты), в субботу цикл заканчивается и в воскресение создается новая полная резервная копия. Таким образом, инкрементное резервное копирование можно выполнять так часто, как это требует план резервного копирования и восстановления. Процесс восстановления инкрементных резервных копий занимает больше времени, чем дифференциальный, поскольку необходимо восстановить как полную резервную копию так и всю цепочку инкрементов предшествующих дню восстановления. Если хотя бы один бэкап в цепочке будет отсутствовать или поврежден, восстановления будет невозможным. Поэтому цепочку инкрементных резервных копий не следует делать очень длинной. А период создания полных резервных копий необходимо выбирать в зависимости от частоты инкрементного резервного копирования.**Преимущества инкрементного резервного копирования:*** Высокая скорость резервного копирования позволяет уменьшить окно резервного копирования* Резервные копии занимают меньше места для хранения* Уменьшает объем (количество) копируемых данных и снижает сетевую нагрузку* Позволяет создавать большее точек восстановления**Недостатки инкрементного резервного копирования:*** Не высокая скорость восстановления данных (необходимо восстановить как начальную полную копию, так и все последующие блоки)* Инкрементное резервное копирование менее надежно, чем дифференциальное (зависит от целостности всех блоков в цепочке)---### Задание 2Установите программное обеспечении Bacula, настройте bacula-dir, bacula-sd,  bacula-fd. Протестируйте работу сервисов.*Пришлите конфигурационные файлы для bacula-dir, bacula-sd,  bacula-fd.*Скриншот-1 к заданию 2:![Скриншот-1](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-2-1.PNG)<ins>bacula-sd.conf</ins>```Storage {  Name = debian-sd #имя хранилища, hostname+sd  SDPort = 9103 #порт на котором оно доступно  WorkingDirectory = "/var/lib/bacula"  Pid Directory = "/run/bacula"  Plugin Directory = "/usr/lib/bacula"  Maximum Concurrent Jobs = 20}Director {  Name = debian-dir #director сервис будет называться hostname+dir  Password = "Uo1sAfX8AkKC9lMJHaNxWmXDAhVVb0EDg"}Director {  Name = debian-mon  Password = "Koj7CKWAhaOlzx3xRUVCBGLh6vKtfl9eM"  Monitor = yes}Messages {  Name = Standard  director = debian-dir = all}Device {  Name = debian-files #имя устройства  Media Type = File #устройство является файлом  Archive Device = /backup #путь в файловой системе где хранятся резервные копии  LabelMedia = yes;  Random Access = Yes; #поддерживает произвольный доступ  AutomaticMount = yes;  RemovableMedia = no; #не съемный накопитель  AlwaysOpen = no; #открывать накопитель только при необходимости  Maximum Concurrent Jobs = 5 #максимальное количество одновременно работающих задач}```Скриншот-2 к заданию 2:![Скриншот-2](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-2-2.PNG)<ins>bacula-fd.conf</ins>```Director {  Name = debian-dir #имя директора, который может сюда подключаться hostname+dir  Password = "dgkO4kDhgFpLuiU7vAXqS2yWZ9rNlNgvw"}Director {  Name = debian-mon  Password = "EGmULTaYudp1HL4MC0kRjViw1Rkf8-jS3"  Monitor = yes}FileDaemon {  Name = debian-fd # название, используется при подключении, hostname+fd  FDport = 9102 # порт, на котором программа ожидает подключения  WorkingDirectory = /var/lib/bacula  Pid Directory = /run/bacula  Maximum Concurrent Jobs = 20  Plugin Directory = /usr/lib/bacula}Messages {  Name = Standard  director = debian-dir = all, !skipped, !restored}```Скриншот-3 к заданию 2:![Скриншот-3](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-2-3.PNG)<ins>bacula-dir.conf</ins>```Director {  Name = debian-dir #имя сервиса hostname+dir  DIRport = 9101 #порт, на котором ожидает соединений сервис  QueryFile = "/etc/bacula/scripts/query.sql" #файл с запросами SQL  WorkingDirectory = "/var/lib/bacula"  PidDirectory = "/run/bacula"  Maximum Concurrent Jobs = 20 #максимальное количество одновременно выполняемых задач  Password = "RUee9uXxvaX__mKkJTxRey0jkEc2_jq5C" #используется для подключения к сервису из консоли  Messages = Standard  DirAddress = 127.0.0.1}Catalog {  Name = default  dbname = "bacula"; DB Address = "localhost"; dbuser = "bacula"; dbpassword = "CRadmin"}Messages {  Name = Standard  director = debian-dir = all, !skipped, !restored}Console {  Name = debian-mon  Password = "nvlNyTlFGK3DhlkcXAYpdFsPaObXt7SQ2"  CommandACL = status, .status}FileSet {  Name = "local"  Include {    Options {	signature = MD5    }    File = /etc  }}Pool {  Catalog = default  Name = LocalPool  Pool Type = Backup  Recycle = yes  AutoPrune = yes  Volume Retention = 40 days  Recycle Oldest Volume = yes  Purge Oldest Volume = yes  Action On Purge = Truncate  Maximum Volume Jobs=1  Maximum Volumes = 40  Label Format = "local-"  Storage = debian-sd}Client {  Name = debian-fd  Address = 127.0.0.1  FDPort = 9102  Catalog = default  Password = "dgkO4kDhgFpLuiU7vAXqS2yWZ9rNlNgvw"  AutoPrune = yes  Maximum Concurrent Jobs = 1}Storage {  Name = debian-sd  Address = 127.0.0.1  SDPort = 9103  Password = "Uo1sAfX8AkKC9lMJHaNxWmXDAhVVb0EDg"  Device = debian-files  Media Type = File  Maximum Concurrent Jobs = 1}Schedule {  Name = "local"  Run = Level=Full daily at 06:00}Job {  Name = "LocalBackup"  Type = Backup  Level = Incremental  Client = debian-fd  FileSet = "local"  Schedule = "local"  Messages = Standard  Pool = LocalPool  Priority = 10  Allow Duplicate Jobs = no  Cancel Queued Duplicates = yes  Cancel Running Duplicates = no}```Долго немог разобраться почему файлы бекап не создавался, оказалось нужно было дать права sudo chown -R bacula:disk /backupСкриншот-4 к заданию 2:![Скриншот-4](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-2-4.PNG)Скриншот-5 к заданию 2:![Скриншот-5](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-2-5.PNG)---### Задание 3Установите программное обеспечении Rsync. Настройте синхронизацию на двух нодах. Протестируйте работу сервиса.*Пришлите рабочую конфигурацию сервера и клиента Rsync.*Скриншот-1 к заданию 3:![Скриншот-1](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-3-1.PNG)Скриншот-2 к заданию 3:![Скриншот-2](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-3-2.PNG)Скриншот-3 к заданию 3:![Скриншот-3](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-3-3.PNG)Скриншот-4 к заданию 3:![Скриншот-4](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-3-4.PNG)Скриншот-5 к заданию 3:![Скриншот-5](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-3-5.PNG)---### Задание со звёздочкой*Это задание дополнительное. Его можно не выполнять. На зачёт это не повлияет. Вы можете его выполнить, если хотите глубже разобраться в материале.---### Задание 4*Настройте резервное копирование двумя или более методами, используя одну из рассмотренных команд для папки /etc/default. Проверьте резервное копирование.*Пришлите рабочую конфигурацию выбранного сервиса по поставленной задаче.***Rsync - Full Backup: ПОЛНОЕ РЕЗЕРВНОЕ КОПИРОВАНИЕ**Скриншот-1 к заданию 4:![Скриншот-1](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-4-1.PNG)**Rsync - Incremental Backup: ИНКРЕМЕНТНОЕ РЕЗЕРВНОЕ КОПИРОВАНИЕ**Скриншот-2 к заданию 4:![Скриншот-2](https://github.com/alex31bel/srlb-homework/blob/srlb-14/img/10-04-3-3.PNG)